#include <stdio.h>
#include "leds_control.h"
#include <unistd.h>


typedef struct{
	int RValue;
	int GValue;
	int BValue;
}color;


//recoit un tableau et l'affiche//
void Setledline(color **tabline, int tabsize){
	for (int row = 0; row < tabsize; row ++){
		for (int col = 0; col < tabsize; col ++){
			setLedColor((row + 1), (col + 1), tabline[row][col].RValue, tabline[row][col].GValue, tabline[row][col].BValue );
		}
	}
}


//créée et affiche un tableau de couleur unie//
void Setonecolor(color color_selected,int tabsize){
	color line [7] = {color_selected, color_selected, color_selected, color_selected, color_selected, color_selected, color_selected};
	color * tabline [7] = {line, line, line, line, line, line, line};
	Setledline(tabline, tabsize);
}


//créée et affiche tableau avec numéro//
void Setnumber(int number, color nbr_color, color bckgrnd, int tabsize){
	if (number == 0){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_5 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);
	}
	if (number == 1){
		color line_1 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, bckgrnd, bckgrnd, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_3 [7] = {bckgrnd, bckgrnd, nbr_color, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_4 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_6 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 2){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, nbr_color, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 3){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, bckgrnd, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 4){
		color line_1 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_6 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 5){
		color line_1 [7] = {bckgrnd, nbr_color, nbr_color, nbr_color, nbr_color, nbr_color, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, nbr_color, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 6){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 7){
		color line_1 [7] = {bckgrnd, nbr_color, nbr_color, nbr_color, nbr_color, nbr_color, bckgrnd};
		color line_2 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd};
		color line_6 [7] = {bckgrnd, bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color line_7 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 8){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);

	}
	if (number == 9){
		color line_1 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_2 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_3 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_4 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color line_5 [7] = {bckgrnd, bckgrnd, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_6 [7] = {bckgrnd, nbr_color, bckgrnd, bckgrnd, bckgrnd, nbr_color, bckgrnd};
		color line_7 [7] = {bckgrnd, bckgrnd, nbr_color, nbr_color, nbr_color, bckgrnd, bckgrnd};
		color *number_tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};
		Setledline(number_tabline, tabsize);
	}
}


void countdown(int countdown,color nbr_color, color bckgrnd, int tabsize){
	for(int count = countdown; count >= 0; count --){
		if (count == 9){
			Setnumber(count, white, black, tabsize);
		}
		if (count == 8){
			Setnumber(count, blue, black, tabsize);
		}
		if (count == 7){
			Setnumber(count, green, black, tabsize);
		}
		if (count == 6){
			Setnumber(count, yellow, black, tabsize);
		}
		if (count == 5){
			Setnumber(count, purple, black, tabsize);
		}
		if (count == 4){
			Setnumber(count, red, black, tabsize);
		}
		if (count == 3){
			Setnumber(count, yellow, white, tabsize);
		}
		if (count == 2){
			Setnumber(count, purple, white, tabsize);
		}
		if (count == 1){
			Setnumber(count, red, white, tabsize);
		}
		if (count == 0){
			Setnumber(count, black, red, tabsize);
		}
			sleep(4);
	}
}


int main(){
	int tabsize = 7;
	//création des couleurs//
	color white, green, blue, red, purple, yellow, black;
	white.BValue = 255;	white.RValue = 255;	white.GValue = 255;	green.GValue = 255;
	green.BValue = 0; green.RValue = 0; blue.BValue = 255; blue.RValue = 0; blue.GValue = 0;
	red.RValue = 255; red.GValue = 0; red.BValue = 0; purple.RValue = 255;
	purple.BValue = 255; purple.GValue = 0;	yellow.GValue = 255; yellow.RValue = 255;
	yellow.BValue = 0; black.GValue = 0; black.BValue = 0; black.RValue = 0;

	//tableau de test initial//
	color line_1 [7] = {red, red, red, red, red, red, red};
	color line_2 [7] = {red, black, black, black, black, black, red};
	color line_3 [7] = {red, black, green, green, green, black, red};
	color line_4 [7] = {red, black, green, yellow, green, black, red};
	color line_5 [7] = {red, black, green, green, green, black, red};
	color line_6 [7] = {red, black, black, black, black, black, red};
	color line_7 [7] = {red, red, red, red, red, red, red};
	color *tabline [7] = {line_1, line_2, line_3, line_4, line_5, line_6, line_7};


//	Setledline(tabline, tabsize);
//	sleep(4);
//	Setnumber(6, blue, white, tabsize);
//	sleep(4);
//	Setonecolor(black, tabsize);
//	sleep(4);
	countdown(9, red, black, tabsize);
}
